DÆ°á»›i Ä‘Ã¢y lÃ  pháº§n **giáº£i thÃ­ch chi tiáº¿t â€“ Ä‘áº§y Ä‘á»§ â€“ dá»… hiá»ƒu** cho **Thuáº­t toÃ¡n thá»© 3: VigenÃ¨re Cipher**, Ä‘Ãºng theo yÃªu cáº§u Lab06.
MÃ¬nh sáº½ trÃ¬nh bÃ y theo 3 pháº§n nhÆ° trÆ°á»›c:

1. **Giáº£i thÃ­ch thuáº­t toÃ¡n**
2. **Giáº£i thÃ­ch Ä‘á» bÃ i**
3. **Nhiá»u phÆ°Æ¡ng phÃ¡p giáº£i bÃ i (khÃ´ng dÃ¹ng code)**

---

# â­ 1) GIáº¢I THUáº¬T TOÃN: **VigenÃ¨re Cipher** (Máº­t mÃ£ Ä‘a báº£ng â€“ polyalphabetic)

## ğŸ”¹ KhÃ¡i niá»‡m tá»•ng quan

VigenÃ¨re cipher lÃ  máº­t mÃ£ **Ä‘a báº£ng chá»¯ cÃ¡i** dÃ¹ng má»™t **key (chuá»—i kÃ½ tá»±)** Ä‘á»ƒ thay Ä‘á»•i phÃ©p dá»‹ch Caesar theo vá»‹ trÃ­.

* Náº¿u Caesar cipher dá»‹ch toÃ n bá»™ vÄƒn báº£n theo 1 khÃ³a k,
* ThÃ¬ VigenÃ¨re cipher sá»­ dá»¥ng **má»™t chuá»—i khÃ³a láº·p láº¡i**, má»—i kÃ½ tá»± trong khÃ³a tÆ°Æ¡ng á»©ng vá»›i 1 phÃ©p dá»‹ch khÃ¡c nhau.

ÄÃ¢y lÃ  má»™t dáº¡ng polyalphabetic substitution â†’ máº¡nh hÆ¡n Caesar nhiá»u láº§n.

---

## ğŸ”¹ CÃ¡ch mÃ£ hÃ³a

Giáº£ sá»­:

* Plaintext: `ATTACKATDAWN`
* Key: `LEMON`

TrÆ°á»›c khi mÃ£ hÃ³a, key Ä‘Æ°á»£c láº·p láº¡i:

* Key láº·p: `LEMONLEMONLE`

Trong Ä‘Ã³ má»—i kÃ½ tá»± Ä‘Æ°á»£c Ã¡nh xáº¡ thÃ nh sá»‘ (A=0, B=1, â€¦, Z=25)

VÃ­ dá»¥:

* 'L' = 11
* 'E' = 4
* 'M' = 12
* 'O' = 14
* 'N' = 13

CÃ´ng thá»©c mÃ£ hÃ³a (giá»‘ng Caesar nhÆ°ng thay khÃ³a theo vá»‹ trÃ­):

```
C[i] = (P[i] + K[i]) mod 26
```

VÃ­ dá»¥:
A (0) + L (11) = 11 â†’ L
T (19) + E (4) = 23 â†’ X
â€¦

Ciphertext thu Ä‘Æ°á»£c:

```
LXFOPVEFRNHR
```

---

## ğŸ”¹ CÃ¡ch giáº£i mÃ£

```
P[i] = (C[i] - K[i] + 26) mod 26
```

---

## ğŸ”¹ Äiá»ƒm máº¡nh

* KhÃ³ bá»‹ phÃ¡ hÆ¡n Caesar vÃ¬ khÃ´ng cÃ³ táº§n suáº¥t cá»‘ Ä‘á»‹nh â†’ má»—i vá»‹ trÃ­ dÃ¹ng má»™t báº£ng dá»‹ch khÃ¡c nhau.

## ğŸ”¹ Äiá»ƒm yáº¿u

Khi khÃ³a láº·p, ta cÃ³ thá»ƒ tÃ¬m **Ä‘á»™ dÃ i khÃ³a** â†’ chia chuá»—i thÃ nh nhiá»u chuá»—i Caesar â†’ phÃ¡ nhÆ° Caesar.

---

# â­ 2) GIáº¢I THÃCH Äá»€ BÃ€I LAB06 (Task 3)

### ğŸ¯ Input

* Má»™t file ciphertext mÃ£ hÃ³a báº±ng VigenÃ¨re
* Dung lÆ°á»£ng > 5000 chá»¯

### ğŸ¯ Output

1. DÃ²ng Ä‘áº§u tiÃªn: khÃ³a (key) tÃ¬m Ä‘Æ°á»£c
2. CÃ¡c dÃ²ng tiáº¿p theo: plaintext Ä‘Ã£ Ä‘Æ°á»£c giáº£i mÃ£

### ğŸ¯ YÃªu cáº§u ká»¹ thuáº­t

* Chá»‰ dá»‹ch chá»¯ cÃ¡i Latin (Aâ€“Z hoáº·c aâ€“z)
* Giá»¯ nguyÃªn dáº¥u cÃ¡ch, dáº¥u cÃ¢u
* KhÃ´ng biáº¿t Ä‘á»™ dÃ i khÃ³a (Ä‘Ã¢y lÃ  pháº§n khÃ³)
* Plaintext lÃ  bÃ i bÃ¡o tiáº¿ng Anh

### ğŸ¯ Gá»£i Ã½ báº¯t buá»™c

* Kasiski examination
* Index of Coincidence (IC)
* Frequency analysis trÃªn tá»«ng â€œCaesar subsetâ€

---

# â­ 3) NHIá»€U PHÆ¯Æ NG PHÃP GIáº¢I (khÃ´ng cáº§n code)

DÆ°á»›i Ä‘Ã¢y lÃ  **5 cÃ¡ch giáº£i mÃ£ VigenÃ¨re** theo má»©c Ä‘á»™ chuáº©n xÃ¡c tá»« cÆ¡ báº£n Ä‘áº¿n nÃ¢ng cao.

---

# ğŸ”¥ CÃ¡ch 1 â€” **Kasiski Examination** (phÆ°Æ¡ng phÃ¡p cá»• Ä‘iá»ƒn)

**Ã tÆ°á»Ÿng chÃ­nh:**

* TÃ¬m cÃ¡c **chuá»—i láº·p láº¡i** trong ciphertext (vÃ­ dá»¥ â€œABCâ€, â€œXYZâ€)
* Äo khoáº£ng cÃ¡ch giá»¯a cÃ¡c láº§n xuáº¥t hiá»‡n
* Æ¯á»›c lÆ°á»£ng Ä‘á»™ dÃ i khÃ³a báº±ng **Æ°á»›c sá»‘ chung** cá»§a cÃ¡c khoáº£ng cÃ¡ch.

### VÃ­ dá»¥ minh há»a:

Ciphertext chá»©a chuá»—i láº·p:

```
â€¦ ABC â€¦ (khoáº£ng cÃ¡ch 48) â€¦ ABC â€¦ (khoáº£ng cÃ¡ch 96) â€¦
```

Æ¯á»›c sá»‘ cá»§a 48 vÃ  96 lÃ :

```
1, 2, 3, 4, 6, 8, 12, 16, 24, 48
```

â†’ Äá»™ dÃ i khÃ³a cÃ³ thá»ƒ lÃ  6, 8, 12, 24 (chá»n giÃ¡ trá»‹ há»£p lÃ½ nháº¥t dá»±a trÃªn IC).

### Æ¯u Ä‘iá»ƒm:

* TÃ¬m Ä‘á»™ dÃ i khÃ³a ráº¥t tá»‘t khi text > 5000 chá»¯
* Ráº¥t máº¡nh trong bÃ i lab vÃ¬ plaintext lÃ  tiáº¿ng Anh chuáº©n

### NhÆ°á»£c Ä‘iá»ƒm:

* Cáº§n nhiá»u chuá»—i láº·p, Ä‘Ã´i khi khÃ´ng cÃ³ Ä‘á»§.

---

# ğŸ”¥ CÃ¡ch 2 â€” **Index of Coincidence (IC)** (hÆ°á»›ng thá»‘ng kÃª máº¡nh nháº¥t)

IC Ä‘o Ä‘á»™ â€œtiáº¿ng Anhâ€ cá»§a má»™t chuá»—i:

* Tiáº¿ng Anh cÃ³ IC ~ **0.065**
* Chuá»—i random cÃ³ IC ~ **0.038**

### CÃ¡ch lÃ m:

1. Thá»­ Ä‘á»™ dÃ i khÃ³a tá»« 1 â†’ N (vÃ­ dá»¥ 1 â†’ 20)
2. Vá»›i má»—i Ä‘á»™ dÃ i k:

   * Chia ciphertext thÃ nh k chuá»—i con (split theo modulo)
   * TÃ­nh IC cá»§a tá»«ng chuá»—i
   * Láº¥y trung bÃ¬nh

### Quy táº¯c chá»n:

* Äá»™ dÃ i khÃ³a **Ä‘Ãºng** sáº½ cho IC gáº§n 0.065
* Äá»™ dÃ i khÃ³a **sai** sáº½ cho IC gáº§n 0.038

### Æ¯u Ä‘iá»ƒm:

* Ráº¥t chÃ­nh xÃ¡c
* Hoáº¡t Ä‘á»™ng tá»‘t dÃ¹ Kasiski khÃ´ng tÃ¬m Ä‘Æ°á»£c chuá»—i láº·p

---

# ğŸ”¥ CÃ¡ch 3 â€” Chia ciphertext thÃ nh cÃ¡c **Caesar Subsets**

Khi biáº¿t hoáº·c Æ°á»›c lÆ°á»£ng Ä‘Æ°á»£c Ä‘á»™ dÃ i khÃ³a `k`:

* Táº¡o `k` chuá»—i con:

  * Subset 0: C[0], C[k], C[2k], C[3k], â€¦
  * Subset 1: C[1], C[k+1], C[2k+1], â€¦
  * ...
  * Subset (k-1)...

â†’ Má»—i chuá»—i con Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng **1 Caesar cipher vá»›i khÃ³a riÃªng**.

### CÃ¡ch giáº£i tá»«ng subset:

* Frequency analysis
* Bigram/trigram
* Chi tiáº¿t phÃ¢n phá»‘i chá»¯ cÃ¡i
* So sÃ¡nh vá»›i táº§n suáº¥t â€œeâ€, â€œtâ€, â€œaâ€

Sau Ä‘Ã³ ghÃ©p tá»«ng khÃ³a nhá» â†’ táº¡o key Ä‘áº§y Ä‘á»§ (vÃ­ dá»¥ key = â€œLEMONâ€).

---

# ğŸ”¥ CÃ¡ch 4 â€” Frequency Analysis theo vector dá»‹ch

Khi cÃ³ subset, ta tÃ¬m khÃ³a báº±ng cÃ¡ch:

1. Thá»­ dá»‹ch subset báº±ng Caesar vá»›i má»i dá»‹ch chuyá»ƒn 0..25
2. ÄÃ¡nh giÃ¡ báº£n decode báº±ng:

   * Táº§n suáº¥t e,t,a,o
   * Bigrams
   * Word-likelihood
3. Chá»n khÃ³a cho subset cÃ³ score cao nháº¥t

Cuá»‘i cÃ¹ng ghÃ©p 26 khÃ³a láº¡i â†’ ra key.

---

# ğŸ”¥ CÃ¡ch 5 â€” Sá»­ dá»¥ng n-gram scoring + hill climbing (máº¡nh nháº¥t)

Giá»‘ng bÃ i 2 nhÆ°ng Ã¡p dá»¥ng cho tá»«ng subset.

Ká»¹ thuáº­t:

* TÃ¬m key length báº±ng IC
* DÃ¹ng hill-climbing Ä‘á»ƒ tá»‘i Æ°u tá»«ng kÃ½ tá»± khÃ³a
* Assignment nÃ o cho plaintext tiáº¿ng Anh tá»± nhiÃªn nháº¥t â†’ khÃ³a Ä‘Ãºng

### Æ¯u Ä‘iá»ƒm:

* CÃ¡ch máº¡nh nháº¥t khi ciphertext cá»±c dÃ i (bÃ i lab >5000 chá»¯)
* Log-likelihood giÃºp tá»± Ä‘á»™ng tÃ¬m key

---

